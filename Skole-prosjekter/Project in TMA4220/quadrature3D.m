function [ I ] = quadrature3D(p1,p2,p3,p4,Nq,g)


    A = 1/6*abs(det([p1-p4;p2-p4;p3-p4]));

 if Nq == 1
     
     I = A*feval(g,1/4*(p1(1)+p2(1)+p3(1)+p4(1)),1/4*(p1(2)+p2(2)+p3(2)+p4(2)),1/4*(p1(3)+p2(3)+p3(3)+p4(3)));
     
 elseif Nq == 4
     a = 1/4+3*sqrt(5)/20;
     b = 1/4-sqrt(5)/20;
     
     I1 = feval(g,a*p1(1)+b*(p2(1)+p3(1)+p4(1)),a*p1(2)+b*(p2(2)+p3(2)+p4(2)),a*p1(3)+b*(p2(3)+p3(3)+p4(3)));
     I2 = feval(g,a*p2(1)+b*(p1(1)+p3(1)+p4(1)),a*p2(2)+b*(p1(2)+p3(2)+p4(2)),a*p2(3)+b*(p1(3)+p3(3)+p4(3)));
     I3 = feval(g,a*p3(1)+b*(p2(1)+p1(1)+p4(1)),a*p3(2)+b*(p2(2)+p1(2)+p4(2)),a*p3(3)+b*(p2(3)+p1(3)+p4(3)));
     I4 = feval(g,a*p4(1)+b*(p2(1)+p3(1)+p1(1)),a*p4(2)+b*(p2(2)+p3(2)+p1(2)),a*p4(3)+b*(p2(3)+p3(3)+p1(3)));
     
     I = A/4*(I1+I2+I3+I4);
     
 elseif Nq == 5
        a = 1/2;
        b = 1/6;
     I1 = -4/5*feval(g,1/4*(p1(1)+p2(1)+p3(1)+p4(1)),1/4*(p1(2)+p2(2)+p3(2)+p4(2)),1/4*(p1(3)+p2(3)+p3(3)+p4(3)));
     I2 = 9/20*feval(g,a*p1(1)+b*(p2(1)+p3(1)+p4(1)),a*p1(2)+b*(p2(2)+p3(2)+p4(2)),a*p1(3)+b*(p2(3)+p3(3)+p4(3)));
     I3 = 9/20*feval(g,a*p2(1)+b*(p1(1)+p3(1)+p4(1)),a*p2(2)+b*(p1(2)+p3(2)+p4(2)),a*p2(3)+b*(p1(3)+p3(3)+p4(3)));
     I4 = 9/20*feval(g,a*p3(1)+b*(p2(1)+p1(1)+p4(1)),a*p3(2)+b*(p2(2)+p1(2)+p4(2)),a*p3(3)+b*(p2(3)+p1(3)+p4(3)));
     I5 = 9/20*feval(g,a*p4(1)+b*(p2(1)+p3(1)+p1(1)),a*p4(2)+b*(p2(2)+p3(2)+p1(2)),a*p4(3)+b*(p2(3)+p3(3)+p1(3)));
     
     I = A*(I1+I2+I3+I4+I5);
     
 else 
     disp('Something went wrong!')
 end


end
